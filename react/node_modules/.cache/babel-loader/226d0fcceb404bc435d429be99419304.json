{"ast":null,"code":"import _classCallCheck from \"/Users/GAMEHERO/Desktop/2DV603/\\u6700\\u540E\\u7684\\u4F5C\\u4E1A/2DV603-master/react/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/GAMEHERO/Desktop/2DV603/\\u6700\\u540E\\u7684\\u4F5C\\u4E1A/2DV603-master/react/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/GAMEHERO/Desktop/2DV603/\\u6700\\u540E\\u7684\\u4F5C\\u4E1A/2DV603-master/react/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/GAMEHERO/Desktop/2DV603/\\u6700\\u540E\\u7684\\u4F5C\\u4E1A/2DV603-master/react/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/GAMEHERO/Desktop/2DV603/\\u6700\\u540E\\u7684\\u4F5C\\u4E1A/2DV603-master/react/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/GAMEHERO/Desktop/2DV603/\\u6700\\u540E\\u7684\\u4F5C\\u4E1A/2DV603-master/react/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/Users/GAMEHERO/Desktop/2DV603/\\u6700\\u540E\\u7684\\u4F5C\\u4E1A/2DV603-master/react/src/Submission/Submit.js\";\nimport React from 'react';\nimport { confirmAlert } from 'react-confirm-alert';\nimport 'react-confirm-alert/src/react-confirm-alert.css';\nimport Utils from '../utils';\nimport Config from '../config';\nimport './Submit.css';\nimport Header from '../Public/Header';\nimport Sider from '../Public/Sider';\n\nvar Submit =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Submit, _React$Component);\n\n  function Submit(props) {\n    var _this;\n\n    _classCallCheck(this, Submit);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Submit).call(this, props));\n    document.title = 'Submission Submit';\n\n    var $this = _assertThisInitialized(_assertThisInitialized(_this));\n\n    var type = props.match.params.type;\n    $this.state = {\n      type: type,\n      typeUpper: type.substring(0, 1).toUpperCase() + type.substring(1),\n      supervisorId: _this.props.location.search.replace('?id=', ''),\n      file: null,\n      member: {\n        groupObj: {}\n      },\n      list: [],\n      schedule: {},\n      agreement: false\n    };\n\n    if (type === 'plan' && props.location.search === '') {\n      Utils.alert('Please select a supervisor', function () {\n        window.location.href = Utils.url('supervisor-list');\n      });\n      return _possibleConstructorReturn(_this, false);\n    }\n\n    Utils.checkMember(function (res) {\n      $this.setState({\n        member: res\n      });\n      var postdata = {};\n      postdata.cookie = Utils.getLoginCookie();\n      postdata.type = $this.state.type;\n      Utils.request(Config.requestUrl + Utils.requestUrl('submission-listOfStudent'), Utils.jsonToForm(postdata), function (res) {\n        $this.setState({\n          list: res\n        });\n      });\n      Utils.request(Config.requestUrl + Utils.requestUrl('schedule-read'), Utils.jsonToForm({\n        type: 'Submit' + $this.state.type\n      }), function (res) {\n        if (res === null) {\n          Utils.alert('No schedule', function () {\n            window.location.href = Utils.url('index-show');\n          });\n          return false;\n        }\n\n        $this.setState({\n          schedule: res\n        });\n      });\n    });\n    _this.fileSelect = _this.fileSelect.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.submit = _this.submit.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(Submit, [{\n    key: \"agreementChange\",\n    value: function agreementChange() {\n      var agree = !this.state.agreement;\n      this.setState({\n        agreement: agree\n      });\n    }\n  }, {\n    key: \"submit\",\n    value: function submit() {\n      var _this2 = this;\n\n      if (!this.state.agreement) {\n        Utils.alert('Please select the agreement first');\n        return false;\n      }\n\n      if (!this.state.file) {\n        Utils.alert('Please the file you want to submit');\n        return false;\n      }\n\n      confirmAlert({\n        title: 'Confirm',\n        message: 'Confirm to submit the file?',\n        buttons: [{\n          label: 'Cancel',\n          onClick: function onClick() {}\n        }, {\n          label: 'Confirm',\n          onClick: function onClick() {\n            var formData = new FormData();\n            formData.append('file', _this2.state.file);\n            formData.append('type', _this2.state.type);\n            formData.append('cookie', Utils.getLoginCookie());\n            formData.append('supervisorId', _this2.state.supervisorId);\n            Utils.upload(Config.requestUrl + Utils.requestUrl('submission-submit'), formData, function (res) {\n              Utils.alert(res, function () {\n                window.location.reload();\n              });\n            }, function (err) {\n              Utils.alert(err);\n            });\n          }\n        }]\n      });\n    }\n  }, {\n    key: \"fileSelect\",\n    value: function fileSelect(e) {\n      var file = e.target.files[0];\n      this.setState({\n        file: file\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var member = this.state.member;\n      var list = this.state.list;\n      var schedule = this.state.schedule;\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115\n        },\n        __self: this\n      }, React.createElement(Sider, {\n        member: member,\n        active1: 'Project ' + this.state.typeUpper,\n        active2: 'Submit Project ' + this.state.typeUpper,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116\n        },\n        __self: this\n      }), React.createElement(Header, {\n        title1: 'Project ' + this.state.typeUpper,\n        title2: 'Submit Project ' + this.state.typeUpper,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"wrap\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119\n        },\n        __self: this\n      }, React.createElement(\"table\", {\n        className: \"table table-striped\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121\n        },\n        __self: this\n      }, React.createElement(\"thead\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122\n        },\n        __self: this\n      }, React.createElement(\"tr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123\n        },\n        __self: this\n      }, React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124\n        },\n        __self: this\n      }, \"Submission\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125\n        },\n        __self: this\n      }, schedule.title))), React.createElement(\"tbody\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      }, React.createElement(\"tr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        },\n        __self: this\n      }, React.createElement(\"td\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130\n        },\n        __self: this\n      }, \"Submission status\"), React.createElement(\"td\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131\n        },\n        __self: this\n      }, list.length > 0 && list[0].submitTime >= schedule.startTime && list[0].submitTime <= schedule.endTime ? list[0].score > 0 ? 'Graded' : 'Submitted for grading' : 'Not submit')), React.createElement(\"tr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139\n        },\n        __self: this\n      }, React.createElement(\"td\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140\n        },\n        __self: this\n      }, \"Deadline\"), React.createElement(\"td\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141\n        },\n        __self: this\n      }, Utils.timeToDate(schedule.endTime))), React.createElement(\"tr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143\n        },\n        __self: this\n      }, React.createElement(\"td\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144\n        },\n        __self: this\n      }, \"Last modified\"), React.createElement(\"td\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145\n        },\n        __self: this\n      }, list.length > 0 && list[0].submitTime >= schedule.startTime && list[0].submitTime <= schedule.endTime ? Utils.timeToDate(list[0].submitTime) : 'Not submit')), React.createElement(\"tr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153\n        },\n        __self: this\n      }, React.createElement(\"td\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154\n        },\n        __self: this\n      }, \"Grading status\"), React.createElement(\"td\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155\n        },\n        __self: this\n      }, list.length > 0 && list[0].submitTime >= schedule.startTime && list[0].submitTime <= schedule.endTime ? Config.scores[list[0].score] : 'Not Graded')))), schedule.endTime < new Date().getTime() / 1000 || schedule.startTime > new Date().getTime() / 1000 || list.length > 0 && list[0].submitTime >= schedule.startTime && list[0].submitTime <= schedule.endTime ? null : React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"agreement\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        type: \"checkbox\",\n        checked: this.state.agreement,\n        onChange: this.agreementChange.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 170\n        },\n        __self: this\n      }), \" I declare that:\", React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 171\n        },\n        __self: this\n      }, \"This assignment is entirely my own work, except where I have included fully-documented references to the work of others\")), React.createElement(\"input\", {\n        type: \"file\",\n        className: \"form-control\",\n        placeholder: \"Choose your file\",\n        name: \"file\",\n        onChange: this.fileSelect,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 173\n        },\n        __self: this\n      }), React.createElement(\"button\", {\n        className: \"btn btn-primary\",\n        onClick: this.submit,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174\n        },\n        __self: this\n      }, \"Submit\"))));\n    }\n  }]);\n\n  return Submit;\n}(React.Component);\n\nexport default Submit;","map":{"version":3,"sources":["/Users/GAMEHERO/Desktop/2DV603/最后的作业/2DV603-master/react/src/Submission/Submit.js"],"names":["React","confirmAlert","Utils","Config","Header","Sider","Submit","props","document","title","$this","type","match","params","state","typeUpper","substring","toUpperCase","supervisorId","location","search","replace","file","member","groupObj","list","schedule","agreement","alert","window","href","url","checkMember","res","setState","postdata","cookie","getLoginCookie","request","requestUrl","jsonToForm","fileSelect","bind","submit","agree","message","buttons","label","onClick","formData","FormData","append","upload","reload","err","e","target","files","length","submitTime","startTime","endTime","score","timeToDate","scores","Date","getTime","agreementChange","Component"],"mappings":";;;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,YAAT,QAA6B,qBAA7B;AACA,OAAO,iDAAP;AAEA,OAAOC,KAAP,MAAkB,UAAlB;AACA,OAAOC,MAAP,MAAmB,WAAnB;AACA,OAAO,cAAP;AAEA,OAAOC,MAAP,MAAmB,kBAAnB;AACA,OAAOC,KAAP,MAAkB,iBAAlB;;IAEMC,M;;;;;AAEF,kBAAYC,KAAZ,EAAkB;AAAA;;AAAA;;AACd,gFAAMA,KAAN;AACAC,IAAAA,QAAQ,CAACC,KAAT,GAAiB,mBAAjB;;AACA,QAAIC,KAAK,wDAAT;;AACA,QAAIC,IAAI,GAAGJ,KAAK,CAACK,KAAN,CAAYC,MAAZ,CAAmBF,IAA9B;AACAD,IAAAA,KAAK,CAACI,KAAN,GAAc;AACVH,MAAAA,IAAI,EAAEA,IADI;AAEVI,MAAAA,SAAS,EAAEJ,IAAI,CAACK,SAAL,CAAe,CAAf,EAAiB,CAAjB,EAAoBC,WAApB,KAAoCN,IAAI,CAACK,SAAL,CAAe,CAAf,CAFrC;AAGVE,MAAAA,YAAY,EAAE,MAAKX,KAAL,CAAWY,QAAX,CAAoBC,MAApB,CAA2BC,OAA3B,CAAmC,MAAnC,EAA2C,EAA3C,CAHJ;AAIVC,MAAAA,IAAI,EAAE,IAJI;AAKVC,MAAAA,MAAM,EAAE;AAACC,QAAAA,QAAQ,EAAE;AAAX,OALE;AAMVC,MAAAA,IAAI,EAAE,EANI;AAOVC,MAAAA,QAAQ,EAAE,EAPA;AAQVC,MAAAA,SAAS,EAAE;AARD,KAAd;;AAUA,QAAGhB,IAAI,KAAG,MAAP,IAAiBJ,KAAK,CAACY,QAAN,CAAeC,MAAf,KAAwB,EAA5C,EAA+C;AAC3ClB,MAAAA,KAAK,CAAC0B,KAAN,CAAY,4BAAZ,EAA0C,YAAU;AAChDC,QAAAA,MAAM,CAACV,QAAP,CAAgBW,IAAhB,GAAuB5B,KAAK,CAAC6B,GAAN,CAAU,iBAAV,CAAvB;AACH,OAFD;AAGA,+CAAO,KAAP;AACH;;AACD7B,IAAAA,KAAK,CAAC8B,WAAN,CAAkB,UAASC,GAAT,EAAa;AAC3BvB,MAAAA,KAAK,CAACwB,QAAN,CAAe;AACXX,QAAAA,MAAM,EAAEU;AADG,OAAf;AAGA,UAAIE,QAAQ,GAAG,EAAf;AACAA,MAAAA,QAAQ,CAACC,MAAT,GAAkBlC,KAAK,CAACmC,cAAN,EAAlB;AACAF,MAAAA,QAAQ,CAACxB,IAAT,GAAgBD,KAAK,CAACI,KAAN,CAAYH,IAA5B;AACAT,MAAAA,KAAK,CAACoC,OAAN,CAAcnC,MAAM,CAACoC,UAAP,GAAkBrC,KAAK,CAACqC,UAAN,CAAiB,0BAAjB,CAAhC,EAA8ErC,KAAK,CAACsC,UAAN,CAAiBL,QAAjB,CAA9E,EAA0G,UAASF,GAAT,EAAa;AACnHvB,QAAAA,KAAK,CAACwB,QAAN,CAAe;AACXT,UAAAA,IAAI,EAAEQ;AADK,SAAf;AAGH,OAJD;AAKA/B,MAAAA,KAAK,CAACoC,OAAN,CAAcnC,MAAM,CAACoC,UAAP,GAAkBrC,KAAK,CAACqC,UAAN,CAAiB,eAAjB,CAAhC,EAAmErC,KAAK,CAACsC,UAAN,CAAiB;AAAC7B,QAAAA,IAAI,EAAE,WAASD,KAAK,CAACI,KAAN,CAAYH;AAA5B,OAAjB,CAAnE,EAAwH,UAASsB,GAAT,EAAa;AACjI,YAAGA,GAAG,KAAG,IAAT,EAAc;AACV/B,UAAAA,KAAK,CAAC0B,KAAN,CAAY,aAAZ,EAA2B,YAAU;AACjCC,YAAAA,MAAM,CAACV,QAAP,CAAgBW,IAAhB,GAAuB5B,KAAK,CAAC6B,GAAN,CAAU,YAAV,CAAvB;AACH,WAFD;AAGA,iBAAO,KAAP;AACH;;AACDrB,QAAAA,KAAK,CAACwB,QAAN,CAAe;AACXR,UAAAA,QAAQ,EAAEO;AADC,SAAf;AAGH,OAVD;AAWH,KAvBD;AAwBA,UAAKQ,UAAL,GAAkB,MAAKA,UAAL,CAAgBC,IAAhB,uDAAlB;AACA,UAAKC,MAAL,GAAc,MAAKA,MAAL,CAAYD,IAAZ,uDAAd;AA9Cc;AA+CjB;;;;sCAEgB;AACb,UAAIE,KAAK,GAAG,CAAC,KAAK9B,KAAL,CAAWa,SAAxB;AACA,WAAKO,QAAL,CAAc;AACVP,QAAAA,SAAS,EAAEiB;AADD,OAAd;AAGH;;;6BAEQ;AAAA;;AACL,UAAG,CAAC,KAAK9B,KAAL,CAAWa,SAAf,EAAyB;AACrBzB,QAAAA,KAAK,CAAC0B,KAAN,CAAY,mCAAZ;AACA,eAAO,KAAP;AACH;;AACD,UAAG,CAAC,KAAKd,KAAL,CAAWQ,IAAf,EAAoB;AAChBpB,QAAAA,KAAK,CAAC0B,KAAN,CAAY,oCAAZ;AACA,eAAO,KAAP;AACH;;AACD3B,MAAAA,YAAY,CAAC;AACTQ,QAAAA,KAAK,EAAE,SADE;AAEToC,QAAAA,OAAO,EAAE,6BAFA;AAGTC,QAAAA,OAAO,EAAE,CACL;AAACC,UAAAA,KAAK,EAAE,QAAR;AAAkBC,UAAAA,OAAO,EAAE,mBAAM,CAAE;AAAnC,SADK,EAEL;AAACD,UAAAA,KAAK,EAAE,SAAR;AACIC,UAAAA,OAAO,EAAE,mBAAM;AACX,gBAAMC,QAAQ,GAAG,IAAIC,QAAJ,EAAjB;AACAD,YAAAA,QAAQ,CAACE,MAAT,CAAgB,MAAhB,EAAwB,MAAI,CAACrC,KAAL,CAAWQ,IAAnC;AACA2B,YAAAA,QAAQ,CAACE,MAAT,CAAgB,MAAhB,EAAwB,MAAI,CAACrC,KAAL,CAAWH,IAAnC;AACAsC,YAAAA,QAAQ,CAACE,MAAT,CAAgB,QAAhB,EAA0BjD,KAAK,CAACmC,cAAN,EAA1B;AACAY,YAAAA,QAAQ,CAACE,MAAT,CAAgB,cAAhB,EAAgC,MAAI,CAACrC,KAAL,CAAWI,YAA3C;AACAhB,YAAAA,KAAK,CAACkD,MAAN,CAAajD,MAAM,CAACoC,UAAP,GAAkBrC,KAAK,CAACqC,UAAN,CAAiB,mBAAjB,CAA/B,EAAsEU,QAAtE,EAAgF,UAAShB,GAAT,EAAa;AACzF/B,cAAAA,KAAK,CAAC0B,KAAN,CAAYK,GAAZ,EAAiB,YAAU;AACvBJ,gBAAAA,MAAM,CAACV,QAAP,CAAgBkC,MAAhB;AACH,eAFD;AAGH,aAJD,EAIG,UAASC,GAAT,EAAa;AACZpD,cAAAA,KAAK,CAAC0B,KAAN,CAAY0B,GAAZ;AACH,aAND;AAOH;AAdL,SAFK;AAHA,OAAD,CAAZ;AAsBH;;;+BAEUC,C,EAAG;AACV,UAAIjC,IAAI,GAAGiC,CAAC,CAACC,MAAF,CAASC,KAAT,CAAe,CAAf,CAAX;AACA,WAAKvB,QAAL,CAAc;AACVZ,QAAAA,IAAI,EAAEA;AADI,OAAd;AAGH;;;6BAEO;AACJ,UAAIC,MAAM,GAAG,KAAKT,KAAL,CAAWS,MAAxB;AACA,UAAIE,IAAI,GAAG,KAAKX,KAAL,CAAWW,IAAtB;AACA,UAAIC,QAAQ,GAAG,KAAKZ,KAAL,CAAWY,QAA1B;AACA,aACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI,oBAAC,KAAD;AAAO,QAAA,MAAM,EAAEH,MAAf;AAAuB,QAAA,OAAO,EAAE,aAAW,KAAKT,KAAL,CAAWC,SAAtD;AAAiE,QAAA,OAAO,EAAE,oBAAkB,KAAKD,KAAL,CAAWC,SAAvG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADJ,EAEI,oBAAC,MAAD;AAAQ,QAAA,MAAM,EAAE,aAAW,KAAKD,KAAL,CAAWC,SAAtC;AAAiD,QAAA,MAAM,EAAE,oBAAkB,KAAKD,KAAL,CAAWC,SAAtF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAFJ,EAII;AAAK,QAAA,SAAS,EAAC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAEI;AAAO,QAAA,SAAS,EAAC,qBAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBADJ,EAEI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAKW,QAAQ,CAACjB,KAAd,CAFJ,CADJ,CADJ,EAOI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,6BADJ,EAEI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACQgB,IAAI,CAACiC,MAAL,GAAY,CAAZ,IACAjC,IAAI,CAAC,CAAD,CAAJ,CAAQkC,UAAR,IAAoBjC,QAAQ,CAACkC,SAD7B,IAEAnC,IAAI,CAAC,CAAD,CAAJ,CAAQkC,UAAR,IAAoBjC,QAAQ,CAACmC,OAF7B,GAGKpC,IAAI,CAAC,CAAD,CAAJ,CAAQqC,KAAR,GAAc,CAAd,GAAgB,QAAhB,GAAyB,uBAH9B,GAII,YALZ,CAFJ,CADJ,EAWI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADJ,EAEI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAK5D,KAAK,CAAC6D,UAAN,CAAiBrC,QAAQ,CAACmC,OAA1B,CAAL,CAFJ,CAXJ,EAeI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBADJ,EAEI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACIpC,IAAI,CAACiC,MAAL,GAAY,CAAZ,IACAjC,IAAI,CAAC,CAAD,CAAJ,CAAQkC,UAAR,IAAoBjC,QAAQ,CAACkC,SAD7B,IAEAnC,IAAI,CAAC,CAAD,CAAJ,CAAQkC,UAAR,IAAoBjC,QAAQ,CAACmC,OAF7B,GAGI3D,KAAK,CAAC6D,UAAN,CAAiBtC,IAAI,CAAC,CAAD,CAAJ,CAAQkC,UAAzB,CAHJ,GAII,YALR,CAFJ,CAfJ,EAyBI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BADJ,EAEI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACIlC,IAAI,CAACiC,MAAL,GAAY,CAAZ,IACAjC,IAAI,CAAC,CAAD,CAAJ,CAAQkC,UAAR,IAAoBjC,QAAQ,CAACkC,SAD7B,IAEAnC,IAAI,CAAC,CAAD,CAAJ,CAAQkC,UAAR,IAAoBjC,QAAQ,CAACmC,OAF7B,GAGI1D,MAAM,CAAC6D,MAAP,CAAcvC,IAAI,CAAC,CAAD,CAAJ,CAAQqC,KAAtB,CAHJ,GAII,YALR,CAFJ,CAzBJ,CAPJ,CAFJ,EA+CKpC,QAAQ,CAACmC,OAAT,GAAkB,IAAII,IAAJ,GAAWC,OAAX,KAAqB,IAAvC,IAAgDxC,QAAQ,CAACkC,SAAT,GAAoB,IAAIK,IAAJ,GAAWC,OAAX,KAAqB,IAAzF,IACAzC,IAAI,CAACiC,MAAL,GAAY,CAAZ,IAAiBjC,IAAI,CAAC,CAAD,CAAJ,CAAQkC,UAAR,IAAoBjC,QAAQ,CAACkC,SAA9C,IAA2DnC,IAAI,CAAC,CAAD,CAAJ,CAAQkC,UAAR,IAAoBjC,QAAQ,CAACmC,OADxF,GACmG,IADnG,GAEG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI;AAAK,QAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI;AAAO,QAAA,IAAI,EAAC,UAAZ;AAAuB,QAAA,OAAO,EAAE,KAAK/C,KAAL,CAAWa,SAA3C;AAAsD,QAAA,QAAQ,EAAE,KAAKwC,eAAL,CAAqBzB,IAArB,CAA0B,IAA1B,CAAhE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADJ,sBAEI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mIAFJ,CADJ,EAKI;AAAO,QAAA,IAAI,EAAC,MAAZ;AAAmB,QAAA,SAAS,EAAC,cAA7B;AAA4C,QAAA,WAAW,EAAC,kBAAxD;AAA2E,QAAA,IAAI,EAAC,MAAhF;AAAuF,QAAA,QAAQ,EAAE,KAAKD,UAAtG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QALJ,EAMI;AAAQ,QAAA,SAAS,EAAC,iBAAlB;AAAoC,QAAA,OAAO,EAAE,KAAKE,MAAlD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBANJ,CAjDR,CAJJ,CADJ;AAkEH;;;;EAxKgB3C,KAAK,CAACoE,S;;AA2K3B,eAAe9D,MAAf","sourcesContent":["import React from 'react';\nimport { confirmAlert } from 'react-confirm-alert';\nimport 'react-confirm-alert/src/react-confirm-alert.css';\n\nimport Utils from '../utils';\nimport Config from '../config';\nimport './Submit.css';\n\nimport Header from '../Public/Header'\nimport Sider from '../Public/Sider'\n\nclass Submit extends React.Component {\n\n    constructor(props){\n        super(props);\n        document.title = 'Submission Submit';\n        let $this = this;\n        let type = props.match.params.type;\n        $this.state = {\n            type: type,\n            typeUpper: type.substring(0,1).toUpperCase() + type.substring(1),\n            supervisorId: this.props.location.search.replace('?id=', ''),\n            file: null,\n            member: {groupObj: {}},\n            list: [],\n            schedule: {},\n            agreement: false\n        };\n        if(type==='plan' && props.location.search===''){\n            Utils.alert('Please select a supervisor', function(){\n                window.location.href = Utils.url('supervisor-list');\n            });\n            return false;\n        }\n        Utils.checkMember(function(res){\n            $this.setState({\n                member: res\n            });\n            let postdata = {};\n            postdata.cookie = Utils.getLoginCookie();\n            postdata.type = $this.state.type;\n            Utils.request(Config.requestUrl+Utils.requestUrl('submission-listOfStudent'), Utils.jsonToForm(postdata), function(res){\n                $this.setState({\n                    list: res\n                });\n            });\n            Utils.request(Config.requestUrl+Utils.requestUrl('schedule-read'), Utils.jsonToForm({type: 'Submit'+$this.state.type}), function(res){\n                if(res===null){\n                    Utils.alert('No schedule', function(){\n                        window.location.href = Utils.url('index-show');\n                    });\n                    return false;\n                }\n                $this.setState({\n                    schedule: res\n                });\n            })\n        });\n        this.fileSelect = this.fileSelect.bind(this);\n        this.submit = this.submit.bind(this);\n    }\n\n    agreementChange(){\n        let agree = !this.state.agreement;\n        this.setState({\n            agreement: agree\n        })\n    }\n\n    submit() {\n        if(!this.state.agreement){\n            Utils.alert('Please select the agreement first')\n            return false;\n        }\n        if(!this.state.file){\n            Utils.alert('Please the file you want to submit')\n            return false;\n        }\n        confirmAlert({\n            title: 'Confirm',\n            message: 'Confirm to submit the file?',\n            buttons: [\n                {label: 'Cancel', onClick: () => {}},\n                {label: 'Confirm',\n                    onClick: () => {\n                        const formData = new FormData();\n                        formData.append('file', this.state.file);\n                        formData.append('type', this.state.type);\n                        formData.append('cookie', Utils.getLoginCookie());\n                        formData.append('supervisorId', this.state.supervisorId);\n                        Utils.upload(Config.requestUrl+Utils.requestUrl('submission-submit'), formData, function(res){\n                            Utils.alert(res, function(){\n                                window.location.reload();\n                            });\n                        }, function(err){\n                            Utils.alert(err);\n                        });\n                    }}\n            ]\n        });\n    }\n\n    fileSelect(e) {\n        let file = e.target.files[0];\n        this.setState({\n            file: file\n        });\n    }\n\n    render(){\n        let member = this.state.member;\n        let list = this.state.list;\n        let schedule = this.state.schedule;\n        return (\n            <div>\n                <Sider member={member} active1={'Project '+this.state.typeUpper} active2={'Submit Project '+this.state.typeUpper}></Sider>\n                <Header title1={'Project '+this.state.typeUpper} title2={'Submit Project '+this.state.typeUpper}></Header>\n\n                <div className=\"wrap\">\n\n                    <table className=\"table table-striped\">\n                        <thead>\n                            <tr>\n                                <th>Submission</th>\n                                <th>{schedule.title}</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            <tr>\n                                <td>Submission status</td>\n                                <td>{\n                                        list.length>0 &&\n                                        list[0].submitTime>=schedule.startTime &&\n                                        list[0].submitTime<=schedule.endTime ?\n                                            (list[0].score>0?'Graded':'Submitted for grading') :\n                                            'Not submit'\n                                }</td>\n                            </tr>\n                            <tr>\n                                <td>Deadline</td>\n                                <td>{Utils.timeToDate(schedule.endTime)}</td>\n                            </tr>\n                            <tr>\n                                <td>Last modified</td>\n                                <td>{\n                                    list.length>0 &&\n                                    list[0].submitTime>=schedule.startTime &&\n                                    list[0].submitTime<=schedule.endTime ?\n                                        Utils.timeToDate(list[0].submitTime) :\n                                        'Not submit'\n                                }</td>\n                            </tr>\n                            <tr>\n                                <td>Grading status</td>\n                                <td>{\n                                    list.length>0 &&\n                                    list[0].submitTime>=schedule.startTime &&\n                                    list[0].submitTime<=schedule.endTime ?\n                                        Config.scores[list[0].score] :\n                                        'Not Graded'\n                                }</td>\n                            </tr>\n                        </tbody>\n                    </table>\n\n                    {schedule.endTime<(new Date().getTime()/1000) || schedule.startTime>(new Date().getTime()/1000) ||\n                    (list.length>0 && list[0].submitTime>=schedule.startTime && list[0].submitTime<=schedule.endTime) ? null :\n                        <div>\n                            <div className=\"agreement\">\n                                <input type=\"checkbox\" checked={this.state.agreement} onChange={this.agreementChange.bind(this)} /> I declare that:\n                                <p>This assignment is entirely my own work, except where I have included fully-documented references to the work of others</p>\n                            </div>\n                            <input type=\"file\" className=\"form-control\" placeholder=\"Choose your file\" name=\"file\" onChange={this.fileSelect} />\n                            <button className=\"btn btn-primary\" onClick={this.submit}>Submit</button>\n                        </div>\n                    }\n                </div>\n            </div>\n        )\n    }\n}\n\nexport default Submit;\n"]},"metadata":{},"sourceType":"module"}