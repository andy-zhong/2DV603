{"ast":null,"code":"import _classCallCheck from \"/Users/GAMEHERO/Desktop/2DV603/\\u6700\\u540E\\u7684\\u4F5C\\u4E1A/2DV603-master/react/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/GAMEHERO/Desktop/2DV603/\\u6700\\u540E\\u7684\\u4F5C\\u4E1A/2DV603-master/react/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/GAMEHERO/Desktop/2DV603/\\u6700\\u540E\\u7684\\u4F5C\\u4E1A/2DV603-master/react/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/GAMEHERO/Desktop/2DV603/\\u6700\\u540E\\u7684\\u4F5C\\u4E1A/2DV603-master/react/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/GAMEHERO/Desktop/2DV603/\\u6700\\u540E\\u7684\\u4F5C\\u4E1A/2DV603-master/react/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/GAMEHERO/Desktop/2DV603/\\u6700\\u540E\\u7684\\u4F5C\\u4E1A/2DV603-master/react/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/Users/GAMEHERO/Desktop/2DV603/\\u6700\\u540E\\u7684\\u4F5C\\u4E1A/2DV603-master/react/src/Submission/View.js\";\nimport React from 'react';\nimport { confirmAlert } from 'react-confirm-alert';\nimport 'react-confirm-alert/src/react-confirm-alert.css';\nimport Utils from '../utils';\nimport Config from '../config';\nimport './View.css';\nimport Header from '../Public/Header';\nimport Sider from '../Public/Sider';\n\nvar View =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(View, _React$Component);\n\n  function View(props) {\n    var _this;\n\n    _classCallCheck(this, View);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(View).call(this, props));\n    document.title = 'Submission View';\n\n    var $this = _assertThisInitialized(_assertThisInitialized(_this));\n\n    var type = props.match.params.type;\n    $this.state = {\n      id: _this.props.location.search.replace('?id=', ''),\n      type: type,\n      typeUpper: type.substring(0, 1).toUpperCase() + type.substring(1),\n      member: {\n        groupObj: {}\n      },\n      submission: {},\n      list: [],\n      canSubmit: true\n    };\n    Utils.checkMember(function (res) {\n      $this.setState({\n        member: res\n      });\n      var postdata = {};\n      postdata.cookie = Utils.getLoginCookie();\n      postdata.id = $this.state.id;\n      Utils.request(Config.requestUrl + Utils.requestUrl('submission-read'), Utils.jsonToForm(postdata), function (res) {\n        $this.setState({\n          submission: res\n        });\n        postdata = {};\n        postdata.id = $this.state.id;\n        postdata.cookie = Utils.getLoginCookie();\n        Utils.request(Config.requestUrl + Utils.requestUrl('feedback-list'), Utils.jsonToForm(postdata), function (res) {\n          $this.setState({\n            list: res\n          });\n\n          for (var i = 0; i < res.length; i++) {\n            if (res[i].mid === $this.state.member.id) {\n              $this.setState({\n                canSubmit: false\n              });\n              return false;\n            }\n          }\n        });\n      });\n    });\n    return _this;\n  }\n\n  _createClass(View, [{\n    key: \"submit\",\n    value: function submit() {\n      var $this = this;\n      confirmAlert({\n        title: 'Confirm',\n        message: 'Confirm to submit your feedback?',\n        buttons: [{\n          label: 'Cancel',\n          onClick: function onClick() {}\n        }, {\n          label: 'Confirm',\n          onClick: function onClick() {\n            var postdata = {};\n            postdata.cookie = Utils.getLoginCookie();\n            postdata.id = $this.state.id;\n            postdata.score = document.getElementById('submitScore').value;\n            postdata.content = document.getElementById('submitContent').value;\n\n            if (postdata.score === '0') {\n              Utils.alert('Please grade the submission');\n              return false;\n            }\n\n            if (postdata.content === '') {\n              Utils.alert('Please enter you review');\n              return false;\n            }\n\n            Utils.request(Config.requestUrl + Utils.requestUrl('feedback-submit'), Utils.jsonToForm(postdata), function (res) {\n              Utils.alert(res, function () {\n                window.location.reload();\n              });\n            }, function (err) {\n              Utils.alert(err);\n            });\n          }\n        }]\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var member = this.state.member;\n      var list = this.state.list;\n      var submission = this.state.submission;\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99\n        },\n        __self: this\n      }, React.createElement(Sider, {\n        member: member,\n        active1: 'Project ' + this.state.typeUpper,\n        active2: 'Manage Project ' + this.state.typeUpper,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100\n        },\n        __self: this\n      }), React.createElement(Header, {\n        title1: 'Project ' + this.state.typeUpper,\n        title2: 'View Project ' + this.state.typeUpper,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 101\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"wrap\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 103\n        },\n        __self: this\n      }, React.createElement(\"table\", {\n        className: \"table table-striped\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 105\n        },\n        __self: this\n      }, React.createElement(\"thead\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106\n        },\n        __self: this\n      }, React.createElement(\"tr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107\n        },\n        __self: this\n      }, React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108\n        },\n        __self: this\n      }, \"Student ID\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109\n        },\n        __self: this\n      }, \"Document\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110\n        },\n        __self: this\n      }, \"Submit Time\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 111\n        },\n        __self: this\n      }, \"Grade Time\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112\n        },\n        __self: this\n      }, \"Grade\"))), React.createElement(\"tbody\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115\n        },\n        __self: this\n      }, React.createElement(\"tr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116\n        },\n        __self: this\n      }, React.createElement(\"td\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117\n        },\n        __self: this\n      }, submission.mid), React.createElement(\"td\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118\n        },\n        __self: this\n      }, React.createElement(\"a\", {\n        href: Config.requestUrl + Utils.requestUrl('submission-download') + '?cookie=' + Utils.getLoginCookie() + '&id=' + submission.id,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118\n        },\n        __self: this\n      }, \"Download\")), React.createElement(\"td\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119\n        },\n        __self: this\n      }, Utils.timeToDate(submission.submitTime)), React.createElement(\"td\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120\n        },\n        __self: this\n      }, Utils.timeToDate(submission.gradeTime)), React.createElement(\"td\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121\n        },\n        __self: this\n      }, Config.scores[submission.score])))), list.length > 0 ? React.createElement(\"div\", {\n        className: \"feedback-list\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"title\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      }, \"Feedback List\"), list.map(function (l, k) {\n        return React.createElement(\"div\", {\n          key: k,\n          className: \"item\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 130\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"info\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 131\n          },\n          __self: this\n        }, React.createElement(\"span\", {\n          className: \"fa fa-user\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 132\n          },\n          __self: this\n        }), React.createElement(\"span\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 133\n          },\n          __self: this\n        }, \"Member ID: \", l.mid), React.createElement(\"span\", {\n          className: \"score\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 134\n          },\n          __self: this\n        }, \"Grade: \", Config.scores[l.score])), React.createElement(\"div\", {\n          className: \"content\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 136\n          },\n          __self: this\n        }, l.content));\n      })) : null, this.state.canSubmit && submission.mid !== member.id ? React.createElement(\"div\", {\n        className: \"feedback-box\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"title\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144\n        },\n        __self: this\n      }, \"Your Feedback:\"), React.createElement(\"select\", {\n        className: \"form-control\",\n        id: \"submitScore\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145\n        },\n        __self: this\n      }, Config.scores.map(function (s, k) {\n        return React.createElement(\"option\", {\n          key: k,\n          value: k,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 147\n          },\n          __self: this\n        }, s);\n      })), React.createElement(\"textarea\", {\n        className: \"form-control\",\n        placeholder: \"Please enter your review of thie submission\",\n        id: \"submitContent\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150\n        },\n        __self: this\n      }), React.createElement(\"button\", {\n        className: \"btn btn-success\",\n        onClick: this.submit.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151\n        },\n        __self: this\n      }, \"Submit Feedback\")) : null));\n    }\n  }]);\n\n  return View;\n}(React.Component);\n\nexport default View;","map":{"version":3,"sources":["/Users/GAMEHERO/Desktop/2DV603/最后的作业/2DV603-master/react/src/Submission/View.js"],"names":["React","confirmAlert","Utils","Config","Header","Sider","View","props","document","title","$this","type","match","params","state","id","location","search","replace","typeUpper","substring","toUpperCase","member","groupObj","submission","list","canSubmit","checkMember","res","setState","postdata","cookie","getLoginCookie","request","requestUrl","jsonToForm","i","length","mid","message","buttons","label","onClick","score","getElementById","value","content","alert","window","reload","err","timeToDate","submitTime","gradeTime","scores","map","l","k","s","submit","bind","Component"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport { confirmAlert } from 'react-confirm-alert';\r\nimport 'react-confirm-alert/src/react-confirm-alert.css';\r\n\r\nimport Utils from '../utils';\r\nimport Config from '../config';\r\nimport './View.css';\r\n\r\nimport Header from '../Public/Header'\r\nimport Sider from '../Public/Sider'\r\n\r\nclass View extends React.Component {\r\n\r\n    constructor(props){\r\n        super(props);\r\n        document.title = 'Submission View';\r\n        let $this = this;\r\n        let type = props.match.params.type;\r\n        $this.state = {\r\n            id: this.props.location.search.replace('?id=', ''),\r\n            type: type,\r\n            typeUpper: type.substring(0,1).toUpperCase() + type.substring(1),\r\n            member: {groupObj: {}},\r\n            submission: {},\r\n            list: [],\r\n            canSubmit: true\r\n        };\r\n        Utils.checkMember(function(res){\r\n            $this.setState({\r\n                member: res\r\n            });\r\n            let postdata = {};\r\n            postdata.cookie = Utils.getLoginCookie();\r\n            postdata.id = $this.state.id;\r\n            Utils.request(Config.requestUrl+Utils.requestUrl('submission-read'), Utils.jsonToForm(postdata), function(res){\r\n                $this.setState({\r\n                    submission: res\r\n                });\r\n                postdata = {};\r\n                postdata.id = $this.state.id;\r\n                postdata.cookie = Utils.getLoginCookie();\r\n                Utils.request(Config.requestUrl+Utils.requestUrl('feedback-list'), Utils.jsonToForm(postdata), function(res){\r\n                    $this.setState({\r\n                        list: res\r\n                    });\r\n                    for(let i=0; i<res.length; i++){\r\n                        if(res[i].mid===$this.state.member.id){\r\n                            $this.setState({\r\n                                canSubmit: false\r\n                            });\r\n                            return false;\r\n                        }\r\n                    }\r\n                });\r\n            });\r\n\r\n        });\r\n    }\r\n\r\n    submit() {\r\n        let $this = this;\r\n        confirmAlert({\r\n            title: 'Confirm',\r\n            message: 'Confirm to submit your feedback?',\r\n            buttons: [\r\n                {label: 'Cancel', onClick: () => {}},\r\n                {label: 'Confirm',\r\n                    onClick: () => {\r\n                        let postdata = {};\r\n                        postdata.cookie = Utils.getLoginCookie();\r\n                        postdata.id = $this.state.id;\r\n                        postdata.score = document.getElementById('submitScore').value;\r\n                        postdata.content = document.getElementById('submitContent').value;\r\n                        if(postdata.score==='0'){\r\n                            Utils.alert('Please grade the submission');\r\n                            return false;\r\n                        }\r\n                        if(postdata.content===''){\r\n                            Utils.alert('Please enter you review');\r\n                            return false;\r\n                        }\r\n                        Utils.request(Config.requestUrl+Utils.requestUrl('feedback-submit'), Utils.jsonToForm(postdata), function(res){\r\n                            Utils.alert(res, function(){\r\n                                window.location.reload();\r\n                            });\r\n                        }, function(err){\r\n                            Utils.alert(err);\r\n                        });\r\n                    }}\r\n            ]\r\n        });\r\n    }\r\n\r\n    render(){\r\n        let member = this.state.member;\r\n        let list = this.state.list;\r\n        let submission = this.state.submission;\r\n        return (\r\n            <div>\r\n                <Sider member={member} active1={'Project '+this.state.typeUpper} active2={'Manage Project '+this.state.typeUpper}></Sider>\r\n                <Header title1={'Project '+this.state.typeUpper} title2={'View Project '+this.state.typeUpper}></Header>\r\n\r\n                <div className=\"wrap\">\r\n\r\n                    <table className=\"table table-striped\">\r\n                        <thead>\r\n                            <tr>\r\n                                <th>Student ID</th>\r\n                                <th>Document</th>\r\n                                <th>Submit Time</th>\r\n                                <th>Grade Time</th>\r\n                                <th>Grade</th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            <tr>\r\n                                <td>{submission.mid}</td>\r\n                                <td><a href={Config.requestUrl+Utils.requestUrl('submission-download')+'?cookie='+Utils.getLoginCookie()+'&id='+submission.id}>Download</a></td>\r\n                                <td>{Utils.timeToDate(submission.submitTime)}</td>\r\n                                <td>{Utils.timeToDate(submission.gradeTime)}</td>\r\n                                <td>{Config.scores[submission.score]}</td>\r\n                            </tr>\r\n                        </tbody>\r\n                    </table>\r\n\r\n                    {list.length>0?\r\n                    <div className=\"feedback-list\">\r\n                        <div className=\"title\">Feedback List</div>\r\n                        {list.map((l, k)=>{\r\n                            return <div key={k} className=\"item\">\r\n                                <div className=\"info\">\r\n                                    <span className=\"fa fa-user\"></span>\r\n                                    <span>Member ID: {l.mid}</span>\r\n                                    <span className=\"score\">Grade: {Config.scores[l.score]}</span>\r\n                                </div>\r\n                                <div className=\"content\">{l.content}</div>\r\n                            </div>\r\n                        })}\r\n                    </div>\r\n                    :null}\r\n\r\n                    {this.state.canSubmit && submission.mid!==member.id ?\r\n                    <div className=\"feedback-box\">\r\n                        <div className=\"title\">Your Feedback:</div>\r\n                        <select className=\"form-control\" id=\"submitScore\">\r\n                            {Config.scores.map((s, k)=>{\r\n                                return <option key={k} value={k}>{s}</option>\r\n                            })}\r\n                        </select>\r\n                        <textarea className=\"form-control\" placeholder=\"Please enter your review of thie submission\" id=\"submitContent\"></textarea>\r\n                        <button className=\"btn btn-success\" onClick={this.submit.bind(this)}>Submit Feedback</button>\r\n                    </div>:null}\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default View;\r\n"]},"metadata":{},"sourceType":"module"}